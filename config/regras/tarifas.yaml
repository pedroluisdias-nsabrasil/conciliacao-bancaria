# Regras de Auto-Conciliação - Tarifas Bancárias
# Sistema de Conciliação Bancária
# Data: 06/11/2025
# Versão: 1.1.0 (+ Tarifa Avulsa PIX)

regras:
  # ============================================================
  # TARIFAS PIX
  # ============================================================
  
  - id: tarifa_pix_avulsa
    nome: "Tarifa Avulsa PIX"
    descricao: "Auto-conciliar tarifas avulsas de envio PIX"
    ativo: true
    prioridade: 10
    
    condicoes:
      - campo: descricao
        operador: regex
        valor: "(?i)(tarifa|taxa)\\s+(avulsa)?\\s*(envio)?\\s+pix"
      - campo: valor
        operador: between
        valor: [0.01, 100.00]
      - campo: tipo
        operador: equals
        valor: "D"
    
    acao:
      tipo: auto_aprovar
      confianca: 0.92
      observacao: "Tarifa Avulsa PIX - Auto-conciliada por regra"
      categoria: "Despesa Bancária - Tarifa PIX"
  
  - id: tarifa_pix_geral
    nome: "Tarifa PIX"
    descricao: "Auto-conciliar tarifas gerais PIX"
    ativo: true
    prioridade: 9
    
    condicoes:
      - campo: descricao
        operador: regex
        valor: "(?i)(tarifa|taxa).*(pix)"
      - campo: valor
        operador: less_than
        valor: 10.00
      - campo: tipo
        operador: equals
        valor: "D"
    
    acao:
      tipo: auto_aprovar
      confianca: 0.90
      observacao: "Tarifa PIX - Auto-conciliada por regra"
      categoria: "Despesa Bancária - Tarifa"
  
  # ============================================================
  # TARIFAS DOC/TED
  # ============================================================
  
  - id: tarifa_doc_ted
    nome: "Tarifa DOC/TED"
    descricao: "Auto-conciliar tarifas de DOC e TED"
    ativo: true
    prioridade: 10
    
    condicoes:
      - campo: descricao
        operador: regex
        valor: "(?i)tarifa.*(doc|ted)"
      - campo: valor
        operador: between
        valor: [0.01, 100.00]
      - campo: tipo
        operador: equals
        valor: "D"
    
    acao:
      tipo: auto_aprovar
      confianca: 0.95
      observacao: "Tarifa bancária DOC/TED - Auto-conciliada por regra"
      categoria: "Despesa Bancária - Tarifa"
  
  # ============================================================
  # MANUTENÇÃO DE CONTA
  # ============================================================
  
  - id: tarifa_manutencao_conta
    nome: "Manutenção de Conta"
    descricao: "Tarifa mensal de manutenção de conta corrente"
    ativo: true
    prioridade: 10
    
    condicoes:
      - campo: descricao
        operador: regex
        valor: "(?i)(manutencao|manutenção|pacote|cesta).*(conta|corrente)"
      - campo: valor
        operador: between
        valor: [0.01, 500.00]
      - campo: tipo
        operador: equals
        valor: "D"
    
    acao:
      tipo: auto_aprovar
      confianca: 0.92
      observacao: "Tarifa de Manutenção - Auto-conciliada por regra"
      categoria: "Despesa Bancária - Manutenção"
  
  # ============================================================
  # JUROS E ENCARGOS
  # ============================================================
  
  - id: iof
    nome: "IOF"
    descricao: "Imposto sobre Operações Financeiras"
    ativo: true
    prioridade: 10
    
    condicoes:
      - campo: descricao
        operador: regex
        valor: "(?i)iof"
      - campo: valor
        operador: less_than
        valor: 1000.00
      - campo: tipo
        operador: equals
        valor: "D"
    
    acao:
      tipo: auto_aprovar
      confianca: 0.95
      observacao: "IOF - Auto-conciliado por regra"
      categoria: "Despesa Bancária - Imposto"
  
  - id: juros_encargos
    nome: "Juros e Encargos"
    descricao: "Juros e encargos bancários"
    ativo: true
    prioridade: 9
    
    condicoes:
      - campo: descricao
        operador: regex
        valor: "(?i)(juros|encargos|mora)"
      - campo: valor
        operador: less_than
        valor: 5000.00
      - campo: tipo
        operador: equals
        valor: "D"
    
    acao:
      tipo: auto_aprovar
      confianca: 0.88
      observacao: "Juros/Encargos - Auto-conciliado por regra"
      categoria: "Despesa Bancária - Juros"
  
  # ============================================================
  # OUTRAS TARIFAS
  # ============================================================
  
  - id: tarifa_boleto
    nome: "Tarifa de Boleto"
    descricao: "Tarifas relacionadas a boletos"
    ativo: true
    prioridade: 9
    
    condicoes:
      - campo: descricao
        operador: regex
        valor: "(?i)(tarifa|taxa).*(boleto|cobrança)"
      - campo: valor
        operador: between
        valor: [0.01, 50.00]
      - campo: tipo
        operador: equals
        valor: "D"
    
    acao:
      tipo: auto_aprovar
      confianca: 0.90
      observacao: "Tarifa de Boleto - Auto-conciliada por regra"
      categoria: "Despesa Bancária - Tarifa"
  
  - id: tarifa_cheque
    nome: "Tarifa de Cheque"
    descricao: "Tarifas relacionadas a cheques"
    ativo: true
    prioridade: 9
    
    condicoes:
      - campo: descricao
        operador: regex
        valor: "(?i)(tarifa|taxa).*(cheque|talão)"
      - campo: valor
        operador: between
        valor: [0.01, 100.00]
      - campo: tipo
        operador: equals
        valor: "D"
    
    acao:
      tipo: auto_aprovar
      confianca: 0.90
      observacao: "Tarifa de Cheque - Auto-conciliada por regra"
      categoria: "Despesa Bancária - Tarifa"

# ============================================================
# NOTAS DE USO
# ============================================================
#
# Prioridades:
#   10 = Regras mais específicas (maior confiança)
#   9  = Regras gerais (confiança média)
#   8  = Regras experimentais
#
# Operadores suportados:
#   - regex: Expressão regular (case-insensitive com (?i))
#   - equals: Igualdade exata
#   - less_than: Menor que
#   - greater_than: Maior que
#   - between: Entre dois valores [min, max]
#
# Campos disponíveis:
#   - descricao: Texto da descrição do lançamento
#   - valor: Valor do lançamento (Decimal)
#   - tipo: Tipo do lançamento ('D' = débito, 'C' = crédito)
#   - data: Data do lançamento
#
# Para adicionar novas regras:
#   1. Copie o template de uma regra existente
#   2. Ajuste id, nome, descrição
#   3. Defina condições (AND lógico entre elas)
#   4. Configure ação (confiança, observação, categoria)
#   5. Teste com dados reais antes de ativar
#
# ============================================================
